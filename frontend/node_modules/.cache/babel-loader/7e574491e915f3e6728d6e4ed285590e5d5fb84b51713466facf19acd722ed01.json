{"ast":null,"code":"import React,{useState}from\"react\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function SolicitudIdentidad(_ref){let{onGuardado}=_ref;const[titular,setTitular]=useState(\"\");const[nombre,setNombre]=useState(\"\");const[apellidos,setApellidos]=useState(\"\");const[nombreComercial,setNombreComercial]=useState(\"\");const[cit,setCit]=useState(\"\");const[actividad,setActividad]=useState(\"\");const[codCnae,setCodCnae]=useState(\"\");const[fechaConstitucion,setFechaConstitucion]=useState(\"\");const handleSubmit=async e=>{e.preventDefault();const codGestor=sessionStorage.getItem(\"usuario\")||\"WEB\";const payload={TITULAR:titular,NOMBRE:nombre,APELLIDOS:apellidos,NOMBRE_COMERCIAL:nombreComercial,CIT:cit,ACTIVIDAD:actividad,COD_CNAE:codCnae,COD_DELEGACION:\"28\",TIPO_IDENTIDAD:\"J\",// Sociedades ‚Üí J\nREGIMEN_ECONOMICO:\"S\",F_ALTA:new Date().toISOString().split(\"T\")[0],F_CONSTITUCION:fechaConstitucion,COD_SOPORTE:1,ID_OBSERVACION:0,PAIS_NIF:\"ES\",COD_GESTOR:codGestor,// del sessionStorage\nVALIDEZ_DATOS:\"S\",PROCESO_ALTA:\"GE\",// üîπ corregido\nEXPORTA:\"N\",NIVEL_COMPLETITUD:0,CLASIF_PYME:\"S\",G3_BLOQUEO:\"X\",IDIOMA:\"S\",DATOS_REGISTRALES:\" \",NUM_SS:\" \",EXP_EXTERNO_WEB:\" \",WEB:\" \",WEB_IDENTIDAD:0,WEB_USUARIO:0,CLASIF_PYME_METODO:\"A\",DECLARAR_ASNEF:\"N\",PERSONA_RESPONSABILIDAD_PUBLICA:\"N\",PAIS_NACIONALIDAD:\"ES\"};try{const response=await fetch(\"http://127.0.0.1:5000/api/identidades\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(payload)});const data=await response.json();console.log(\"‚úÖ Respuesta backend:\",data);if(response.ok){alert(\"‚úÖ Sociedad guardada con √©xito\");if(onGuardado&&data.REF_ID){onGuardado(data.REF_ID);// devolvemos REF_ID al padre\n}}else{alert(\"‚ùå Error al guardar: \"+(data.error||\"desconocido\"));}}catch(error){console.error(\"‚ùå Error al enviar:\",error);alert(\"Error de conexi√≥n con el servidor\");}};return/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Solicitud Sociedades\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Titular\",value:titular,onChange:e=>setTitular(e.target.value)}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Nombre\",value:nombre,onChange:e=>setNombre(e.target.value)}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Apellidos\",value:apellidos,onChange:e=>setApellidos(e.target.value)}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Nombre Comercial\",value:nombreComercial,onChange:e=>setNombreComercial(e.target.value)}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"CIT\",value:cit,onChange:e=>setCit(e.target.value)}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Actividad\",value:actividad,onChange:e=>setActividad(e.target.value)}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"C\\xF3digo CNAE\",value:codCnae,onChange:e=>setCodCnae(e.target.value)}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",placeholder:\"Fecha Constituci\\xF3n\",value:fechaConstitucion,onChange:e=>setFechaConstitucion(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Enviar\"})]});}export default SolicitudIdentidad;","map":{"version":3,"names":["React","useState","jsx","_jsx","jsxs","_jsxs","SolicitudIdentidad","_ref","onGuardado","titular","setTitular","nombre","setNombre","apellidos","setApellidos","nombreComercial","setNombreComercial","cit","setCit","actividad","setActividad","codCnae","setCodCnae","fechaConstitucion","setFechaConstitucion","handleSubmit","e","preventDefault","codGestor","sessionStorage","getItem","payload","TITULAR","NOMBRE","APELLIDOS","NOMBRE_COMERCIAL","CIT","ACTIVIDAD","COD_CNAE","COD_DELEGACION","TIPO_IDENTIDAD","REGIMEN_ECONOMICO","F_ALTA","Date","toISOString","split","F_CONSTITUCION","COD_SOPORTE","ID_OBSERVACION","PAIS_NIF","COD_GESTOR","VALIDEZ_DATOS","PROCESO_ALTA","EXPORTA","NIVEL_COMPLETITUD","CLASIF_PYME","G3_BLOQUEO","IDIOMA","DATOS_REGISTRALES","NUM_SS","EXP_EXTERNO_WEB","WEB","WEB_IDENTIDAD","WEB_USUARIO","CLASIF_PYME_METODO","DECLARAR_ASNEF","PERSONA_RESPONSABILIDAD_PUBLICA","PAIS_NACIONALIDAD","response","fetch","method","headers","body","JSON","stringify","data","json","console","log","ok","alert","REF_ID","error","onSubmit","children","type","placeholder","value","onChange","target"],"sources":["/home/administrador/desarrollo_avalmadrid/Comercial_tool/frontend/src/components/SolicitudIdentidad.jsx"],"sourcesContent":["import React, { useState } from \"react\";\n\nfunction SolicitudIdentidad({ onGuardado }) {\n  const [titular, setTitular] = useState(\"\");\n  const [nombre, setNombre] = useState(\"\");\n  const [apellidos, setApellidos] = useState(\"\");\n  const [nombreComercial, setNombreComercial] = useState(\"\");\n  const [cit, setCit] = useState(\"\");\n  const [actividad, setActividad] = useState(\"\");\n  const [codCnae, setCodCnae] = useState(\"\");\n  const [fechaConstitucion, setFechaConstitucion] = useState(\"\");\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n\n    const codGestor = sessionStorage.getItem(\"usuario\") || \"WEB\";\n\n    const payload = {\n      TITULAR: titular,\n      NOMBRE: nombre,\n      APELLIDOS: apellidos,\n      NOMBRE_COMERCIAL: nombreComercial,\n      CIT: cit,\n      ACTIVIDAD: actividad,\n      COD_CNAE: codCnae,\n      COD_DELEGACION: \"28\",\n      TIPO_IDENTIDAD: \"J\", // Sociedades ‚Üí J\n      REGIMEN_ECONOMICO: \"S\",\n      F_ALTA: new Date().toISOString().split(\"T\")[0],\n      F_CONSTITUCION: fechaConstitucion,\n      COD_SOPORTE: 1,\n      ID_OBSERVACION: 0,\n      PAIS_NIF: \"ES\",\n      COD_GESTOR: codGestor, // del sessionStorage\n      VALIDEZ_DATOS: \"S\",\n      PROCESO_ALTA: \"GE\", // üîπ corregido\n      EXPORTA: \"N\",\n      NIVEL_COMPLETITUD: 0,\n      CLASIF_PYME: \"S\",\n      G3_BLOQUEO: \"X\",\n      IDIOMA: \"S\",\n      DATOS_REGISTRALES: \" \",\n      NUM_SS: \" \",\n      EXP_EXTERNO_WEB: \" \",\n      WEB: \" \",\n      WEB_IDENTIDAD: 0,\n      WEB_USUARIO: 0,\n      CLASIF_PYME_METODO: \"A\",\n      DECLARAR_ASNEF: \"N\",\n      PERSONA_RESPONSABILIDAD_PUBLICA: \"N\",\n      PAIS_NACIONALIDAD: \"ES\",\n    };\n\n    try {\n      const response = await fetch(\"http://127.0.0.1:5000/api/identidades\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(payload),\n      });\n\n      const data = await response.json();\n      console.log(\"‚úÖ Respuesta backend:\", data);\n\n      if (response.ok) {\n        alert(\"‚úÖ Sociedad guardada con √©xito\");\n        if (onGuardado && data.REF_ID) {\n          onGuardado(data.REF_ID); // devolvemos REF_ID al padre\n        }\n      } else {\n        alert(\"‚ùå Error al guardar: \" + (data.error || \"desconocido\"));\n      }\n    } catch (error) {\n      console.error(\"‚ùå Error al enviar:\", error);\n      alert(\"Error de conexi√≥n con el servidor\");\n    }\n  };\n\n  return (\n    <form onSubmit={handleSubmit}>\n      <h2>Solicitud Sociedades</h2>\n      <input type=\"text\" placeholder=\"Titular\" value={titular} onChange={(e) => setTitular(e.target.value)} />\n      <input type=\"text\" placeholder=\"Nombre\" value={nombre} onChange={(e) => setNombre(e.target.value)} />\n      <input type=\"text\" placeholder=\"Apellidos\" value={apellidos} onChange={(e) => setApellidos(e.target.value)} />\n      <input type=\"text\" placeholder=\"Nombre Comercial\" value={nombreComercial} onChange={(e) => setNombreComercial(e.target.value)} />\n      <input type=\"text\" placeholder=\"CIT\" value={cit} onChange={(e) => setCit(e.target.value)} />\n      <input type=\"text\" placeholder=\"Actividad\" value={actividad} onChange={(e) => setActividad(e.target.value)} />\n      <input type=\"text\" placeholder=\"C√≥digo CNAE\" value={codCnae} onChange={(e) => setCodCnae(e.target.value)} />\n      <input type=\"date\" placeholder=\"Fecha Constituci√≥n\" value={fechaConstitucion} onChange={(e) => setFechaConstitucion(e.target.value)} />\n      <button type=\"submit\">Enviar</button>\n    </form>\n  );\n}\n\nexport default SolicitudIdentidad;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}